
# L0

## Описание проекта

Небольшой микросервис на Go по работе с заказами с использованием базы данных PostgreSQL и очереди сообщений Apache Kafka. Сервис имеет следующие функции:

- генерация 10 заказов в базе данных

- поиск заказа по UID и его отображение

Взаимодействие происходит с HTTP-сервером, который формирует сообщения в Kafka по нужному топику, после чего эти сообщения получает сервис, выполняющий их обработку и посылающий ответное сообщение обратно на сервер.

Также реализован LRU-кэш на стороне сервера, выдающий данные заказа по запросу при их наличии в нем. Если данные по запросу отсутсвуют, то происходит запрос в БД.

## Структура проекта

![Структура](/L0/schema.png)
## Запуск проекта

### Используя Docker Compose

При наличии Docker запуск производится через файл Docker Compose. Для этого необходимо ввести следующуюю команду:

```bash
  docker-compose up -d --build
```

После этого необходимо перейти в браузер по адресу:

```bash
  http://localhost:8080/orders
```

### Отдельный запуск компонентов

Предварительно на компьютере должны быть установлены Apache Kafka и PostgreSQL, в последней из которых необходимо создать таблицы согласно модели данных, представленной в файле model.json в корне проекта.

Для запуска проекта необходимо выполнить следующие действия:

- запустить сервера Zookeeper и Kafka:

```bash
  .\bin\windows\zookeeper-server-start.bat .\config\zookeeper.properties.
  .\bin\windows\kafka-server-start.bat .\config\server.properties
```

- запустить HTTP-сервер:

```bash
  go run server.go
```

- запустить сервис обработки заказов:

```bash
  go run service.go
```

- перейти в браузере по адресу:

```bash
  http://localhost:8080/orders
```
## HTTP-эндпоинты

#### Главная страница

```http
  /orders
```

#### Генерация 10 заказов

```http
  POST /generate
```

#### Поиск заказа по UID

```http
  GET /orders/${order_uid}
```

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `order_uid`      | `string` | **Required**. UID заказа для поиска |